SELECT 
    PCPEDC.CODSUPERVISOR, 
    PCPRODUT.CODFORNEC, 
    PCFORNEC.FORNECEDOR, 
    PCPEDI.CODPROD, 
    PCPRODUT.DESCRICAO,
    PCMARCA.MARCA,
    PCPRODUT.CODFAB,  
    PCPRODUT.EMBALAGEM,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '01' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES01,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '02' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES02,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '03' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES03,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '04' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES04,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '05' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES05,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '06' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES06,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '07' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES07,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '08' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES08,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '09' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES09,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '10' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES10,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '11' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES11,
    SUM(CASE WHEN TO_CHAR(PCPEDI.DATA, 'MM') = '12' THEN NVL(PCPEDI.QT, 0) ELSE 0 END) AS QTVENDAMES12,
    SUM(NVL(PCPEDI.QT, 0)) AS QTVENDATOT
FROM 
    PCPEDC
JOIN 
    PCPEDI ON PCPEDC.NUMPED = PCPEDI.NUMPED
JOIN 
    PCPRODUT ON PCPEDI.CODPROD = PCPRODUT.CODPROD
JOIN 
    PCUSUARI ON PCPEDC.CODUSUR = PCUSUARI.CODUSUR
JOIN 
    PCFORNEC ON PCPRODUT.CODFORNEC = PCFORNEC.CODFORNEC
JOIN 
    PCSUPERV ON PCUSUARI.CODSUPERVISOR = PCSUPERV.CODSUPERVISOR
JOIN 
    PCCLIENT ON PCPEDC.CODCLI = PCCLIENT.CODCLI
JOIN 
    PCPRACA ON PCCLIENT.CODPRACA = PCPRACA.CODPRACA
JOIN 
    PCDEPTO ON PCPRODUT.CODEPTO = PCDEPTO.CODEPTO
JOIN
    PCMARCA ON PCMARCA.CODMARCA = PCPRODUT.CODMARCA
WHERE 
    PCPEDC.DATA BETWEEN TO_DATE(:DATA1) AND TO_DATE(:DATA2)
    AND PCPEDI.DATA BETWEEN TO_DATE(:DATA1) AND TO_DATE(:DATA2)
    AND PCPRODUT.EMBALAGEM LIKE :EMBALAGEM
    AND PCPEDC.DTCANCEL IS NULL
    AND PCPEDC.POSICAO = 'F'
    AND PCPEDC.CONDVENDA IN (1)
GROUP BY 
    PCPEDC.CODSUPERVISOR, 
    PCPRODUT.CODFORNEC, 
    PCFORNEC.FORNECEDOR,  
    PCPEDI.CODPROD, 
    PCPRODUT.DESCRICAO,
    PCMARCA.MARCA,
    PCPRODUT.CODFAB, 
    PCPRODUT.EMBALAGEM
ORDER BY 
    CASE PCPEDC.CODSUPERVISOR
    WHEN x THEN 1
    WHEN y THEN 2
    WHEN z THEN 3
    ELSE 8
  END,
    PCPRODUT.DESCRICAO,
    PCMARCA.MARCA,
  QTVENDATOT DESC;
